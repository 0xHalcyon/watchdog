$def with (pol, pos)

$if pol.is_current:
    $var head: <script src="http://maps.google.com/maps?file=api&amp;v=2&amp;key=ABQIAAAA32O3YO3sztAoMSWYheUtTBQYu38vSyEOJo4J0P8Mwlrd5U_lzhQ2ZoxaOYKY-qh7R36VeBWvCtHU5g" type="text/javascript"></script> <script src="/static/js/gmap-wms.js"></script> <script src="/static/js/distmap.js"></script> <script type="text/javascript">distcenter('googlemap', "$((pol.district and pol.district.name or '').replace('-0', '').replace('-', ''))", [$(pol.district and pol.district.center_lat or 0.0), $(pol.district and pol.district.center_lng or 0.0), $(pol.district and pol.district.zoom_level and (pol.district.zoom_level - 2) or 0.0)])</script>

$var title: $pol.title $pol.firstname $pol.middlename $pol.lastname

$var sidebar: None

$if pol.is_current:
    $var pretext: <div id="sidebarmap"  style="clear: right; margin-top: -24px;"><div id="googlemap" class="sidemap"></div><!--<input type="text" name="zip" class="zipcode" value="Enter your zip" />--><div class="postit" style="margin: 10px 0px 10px 0px !important; text-align: center; padding: 3px;"><a href="/share?url=$getpath()&title=$pol.firstname $pol.middlename $pol.lastname"><strong>Share this page</strong></a></div></div>
    
$var width: 90%
$var color: white


<style>
    table.contributors { width: 100%; }
    table.contributors td { text-align: right;}
    table.contributors th { font-weight: normal;}
    table.interest_group_agreement td { text-align: right;}
</style>

<div class="rep-info">
<h1>$pol.title $pol.firstname $pol.middlename $pol.lastname</h1>

<table class="structure"><tr>

$if pol.photo_path:
    <td style="padding-right: 10px; width: 5em;"><a href="http://watchdog.net$pol.photo_path"><img src="http://watchdog.net$pol.photo_path" alt="Headshot" class="headshot" style="padding: 7px; border: 1px solid #999;" /></a></td>

<td rowspan="2">

  $if pol.nickname: known as "$pol.nickname"<br />
  $if pol.birthday:
      b. $pol.birthday,\
      $if pol.birthplace: $pol.birthplace\
      <br />
$#$if pol.capitolwords:
$#    $for w in pol.capitolwords:
$#        <p>$w.word &nbsp; &nbsp; $w.word_count</p>
  $if pol.district:
      represents <a href="/us/$(pol.district and pol.district.name or '')">$(pol.district and pol.district.name or 'None')</a><br />
  $if pol.party:
	  $pol.party<br /> 
  $if pol.religion:
	  $pol.religion<br />

$if pol.education:
    Education: $pol.education<br />
$if pol.last_elected_year:
	Last elected in $pol.last_elected_year receiving $commify(pol.n_vote_received) ($pol.pct_vote_received%) votes.<br />
$if pol.officeurl:
  <a href="$pol.officeurl">Official website</a><br /><br />

<!-- <a href="/writerep" class="more">Write $pol.firstname $pol.lastname</a> 

  <span style="color:#EE4400; font-style:italic;">or call at 000-000-0000</a></span>  -->
  


</td>

</tr><tr>

<td style="padding-top: 3px; margin: 0px; color: #EE4400"></td>

</tr></table>
</div>
<table class="structure">
<tr><td width="50%">
<h2 class="rep">Money</h2>

$def spark(label, data, polid, by, unit='', url=None):
    $if label:
        <td style="white-space:nowrap; padding-left: 6px;">$:label</td>
    $if not data:
        $ data = 0
    $ display = commify(data) + ' ' + unit
    $if unit == '$':
        $ display = unit + commify(data)
    $elif unit and unit[0] == '%':
        $ display = '%d' % int(abs(data) * 100) + unit
    $if url:
        <td class="sparkdata"><a href="$url">$display</a></td>
    $else:
        <td class="sparkdata" style="width: 100%">$display</td>
    <td class="sparkline"><a href="/p/by/$by#$polid"
           ><img src="/p/by/$by/distribution.png?point=$data"
                 class="sparkline" /></a></td>
    <td class="sparknum"><sup>(#${pos('politician',by,polid)})</sup></td>

<table class="structure charted"><tbody>
$if pol.money_raised:
    <tr class="even">
      $:spark('Raised', pol.money_raised, pol.id, 'money_raised', '$')
    </tr><tr class="odd">
      $:spark('Spent', pol.pct_spent, pol.id, 'pct_spent', '%')
    </tr><tr class="even">
      $:spark('From self', pol.pct_self, pol.id, 'pct_self', '%')</td>
    </tr><tr class="odd">
      $:spark('From individuals', pol.pct_indiv, pol.id, 'pct_indiv', '%')</td>
    </tr><tr class="even">
      $:spark('From <acronym title="Political Action Committees">PAC</acronym>s', pol.pct_pac, pol.id, 'pct_pac', '%')
    </tr>
$else:
    <tr><th>No information available.</td></tr>
</tbody></table>
</td><td class="width: 50%">
<h2 class="rep">Earmarks</h2>

<table class="charted structure"><tbody>
$if pol.n_earmark_requested:
  <tr class="even">
    $:spark('Requested', pol.n_earmark_requested, pol.id, 'n_earmark_requested', url='/p/'+pol.id+'/earmarks')
  </tr><tr class="odd">
    $:spark('Total cost', pol.amt_earmark_requested, pol.id, 'amt_earmark_requested', '$')
  </tr><tr class="even">
    $:spark('Received', pol.n_earmark_received, pol.id, 'n_earmark_received')
  </tr><tr class="odd">
    $:spark('Total cost', pol.amt_earmark_received, pol.id, 'amt_earmark_received', '$')
  </tr>
  <tr><td colspan="4" class="disclaimer">Data for fiscal year 2008</td></tr>
$else:
    <tr><th>No information available.</td></tr>
</tbody></table>
</td></tr><tr><td width="50%" style="padding-bottom: 10px;">

<h2 class="rep" style="clear: both;">Voting Analysis</h2>

<table class="charted structure" style="width: 100%"><tbody>
$if pol.nominate:
    <tr class="even">
    $:spark('Ideology', pol.nominate, pol.id, 'nominate', '% right-wing' if pol.nominate >= 0 else '% left-wing')
    </tr>
$if pol.predictability:
    <tr class="odd">
    $:spark('Predictable', pol.predictability, pol.id, 'predictability', '%')
    </tr>
    <tr><td colspan="4" class="disclaimer">Unpredictable equals maverick</td></tr>
$else:
    <tr><th>No information available.</td></tr>
</tbody></table>

<h2 class="rep">Speeches</h2>

<table class="charted structure" border="0"><tbody>
$if pol.n_speeches:
  <tr class="even">
    $:spark('Spoke', pol.n_speeches, pol.id, 'n_speeches', 'times', 'http://www.govtrack.us/congress/person.xpd?tab=speeches&id='+(pol.govtrackid or ''))
  </tr><tr class="odd">
    $:spark('Avg. length', pol.words_per_speech, pol.id, 'words_per_speech', 'words')
  </tr>
  <tr><td colspan="4" class="disclaimer">Data for 110th Congress</td></tr>
$else:
    <tr><th>No information available.</td></tr>  
  </tbody></table>  
  
</td><td width="50%">

<h2 class="rep">Bills</h2>

<table class="charted structure"><tbody>
$if pol.n_bills_cosponsored:
  <tr class="even">
    $:spark('Co-sponsored', pol.n_bills_cosponsored, pol.id, 'n_bills_cosponsored')
  </tr>
  <tr class="odd">
    $:spark('Introduced', pol.n_bills_introduced, pol.id, 'n_bills_introduced', url='/p/'+pol.id+'/introduced')
  </tr>
  <tr class="even">
    $:spark('Debated', pol.n_bills_debated, pol.id, 'n_bills_debated')
  </tr>
  <tr class="odd">
    $:spark('Enacted', pol.n_bills_enacted, pol.id, 'n_bills_enacted')
  </tr>
$else:
    <tr><th>No information available.</td></tr>
</tbody></table>

</td></tr>

$if pol.capitolwords:
    <tr><td class="rule" colspan="2" style="color: #638f45;">
    <a href="http://capitolwords.org/lawmaker/$pol.bioguideid" style="text-decoration: underline;  color: #638f45">Capitol Word Frequency</a>&nbsp;&rarr;&nbsp; 
    $for w in pol.capitolwords:
        <nobr><a href="http://capitolwords.org/word/$w.word">$w.word</a> <sup>($w.word_count)</sup></nobr>
    </td></tr>


$if pol.related_groups:
    <tr><td colspan="2">
    <h2 class="rep">Interest Group Alignment</h2>
    <table cellpadding="0" cellspacing="0" width="100%" class="interest_group_agreement">
    $ trclass = "odd"
    <tbody><tr><th>Group</td><th>Agreement</td></tr>
    $for group in pol.related_groups:
        <tr class="$loop.parity">
          <td style="padding-left: 6px;">$group.longname</td>
          <td>$int(group.agreement * 100)% (<a href="/p/$pol.id/$group.id">$group.agreed/$group.total votes</a>)</td>
         </tr> 
    <tr><td colspan="2"><span style="color: #EE4400"><a href="/p/$pol.id/groups" class="more">More interest groups</a>&nbsp;&rarr;</span></td></tr>        
    </tbody></table>
    </td></tr>


$if pol.handshakes:
    <tr><td colspan="2" class="rule">
    <h2 class="rep">Handshakes</h2>
    <table cellpadding="0" cellspacing="0" width="100%" class="handshakes">
    <tbody><tr>
            <td width='50%'><b>Corporation</b></td>
            <td colspan="2"><b>Donations</b></td>
            <th>Earmarks</th>
            <th>Year</th></tr>
    $for h in pol.handshakes:
        $ corporation = h.corporation.replace(' ', '-')
        <tr class="$loop.parity">
           <td>$h.corporation.title()</td>
           <td class="sparkdata">\$$commify(h.corp2pol)</td>
           <td class="sparkline">
               $ query = 'from=%s&to=%s&point=%s' % (urlquote(h.corporation), h.politician_id, h.corp2pol)
               <a href="/contrib/?$query">
                   <img src="/contrib/distribution.png?$query" class="sparkline" />
               </a>
           </td>
           <td>\$$h.pol2corp</td>
           <td>$h.year</td>
        </tr>
    </tbody></table>
    </td></tr>

$if pol.contributors:
    <tr><td colspan="2" class="rule">
        <h2 class="rep">Top Contributors</h2>
        <table class="charted structure contributors" style="width: 100%"><tbody>
        $for c in pol.contributors:
            $ names = c.name.lower().replace(',', '').split(' ')
            $ name = '_'.join(names[1:])+'_'+names[0]
            <tr class="$loop.parity">
                <th>$loop.index <a href="/contrib/$c.zip/$name">$format_name(c.name.title())</a></th>
                <td>\$$commify(int(c.amt))</td>
            </tr>
        <tr><td colspan="2"><span style="color: #EE4400"><a href="/p/$pol.id/contribs" class="more">More contributors</a>&nbsp;&rarr;</span></td></tr>
        </tbody></table>
    </td></tr>

$def niceurl(url):
    $:url.lower().replace(' ', '_')

$if pol.contributors:
    <tr><td colspan="2" class="rule">
        <h2 class="rep">Top Contributor Employers</h2>
        <table class="charted structure contributors" style="width: 100%"><tbody>
        $for c in pol.contributor_employers:
            <tr class="$loop.parity">
            <th>$loop.index <a href="/empl/$:niceurl(c.employer_stem)">$c.employer_stem.title()</a></th>
            <td>\$$commify(int(c.amt))</td>
            </tr>
        <tr><td colspan="2"><span style="color: #EE4400"><a href="/p/$pol.id/contrib-employers" class="more">More contributors</a>&nbsp;&rarr;</span></td></tr></tbody></table>
    </td></tr>
    
$if pol.lob_contribs:
     <tr><td colspan="2" class="rule">
     <h2 class="rep">Top Lobby Contributors</h2>
     <table class="charted structure contributors" style="width: 100%"><tbody>
     $for c in pol.lob_contribs:
         $def whom():
     		${(c.contact_name if c.contact_name else ((c.prefix or '') + ' ' + (c.firstname or '') + ' ' + (c.middlename or '') + ' ' + (c.lastname or '') + ' ' + (c.suffix or ''))).title()}
         <tr class="$loop.parity">
             <th>$loop.index <a href="/lob/f/$c.filing_id">$:whom() - $c.name.title()</a></th>
     		<td>\$$commify(c.amount)</td>
         </tr>
     <tr><td colspan="2"><span style="color: #EE4400"><a href="/p/$pol.id/lobby" class="more">More lobby contributors</a>&nbsp;&rarr;</span></td></tr>        
     </tbody></table>
     </td></tr>

</table>

<div class="sources">
  Money data from <nobr><a href="http://www.fec.gov/" class="external">the FEC</a>.</nobr>
  Politician information from 
  $if pol.votesmartid:
      <a href="http://votesmart.org/bio.php?can_id=$pol.votesmartid" class="external">Project Vote Smart</a>,
      <a href="$pol.wikipedia" class="external">Wikipedia</a>, and 
      <a href="http://www.govtrack.us/congress/person.xpd?id=$pol.govtrackid" class="external">GovTrack</a>.
      Earmark information from 
      <a href="http://taxpayer.net/earmarks.php" class="external">Taxpayers for Common Sense</a>.
      Interest group alignment from 
      <a href="http://maplight.org/map/us/legislator" class="external">MAPLight.org</a>.
      Ideology and predictability from
      <a href="http://voteview.com/" class="external">VoteView</a>.
  $if pol.photo_credit_text:
      Photo from 
      <a href="$pol.photo_credit_url" class="external">$pol.photo_credit_text</a>.
      Some campaign finance information from 
      <a href="http://opensecrets.org/politicians/summary.asp?CID=$pol.opensecretsid" class="external">Open Secrets</a>.
  $else:
      various sources.  
</div>

<p><strong>Developers:</strong> Get this page in <a href="${pol.id.lower()}.n3">N3</a>, <a href="${pol.id.lower()}.xml">XML</a>, or <a href="${pol.id.lower()}.json">JSON</a>.</p>

<p><em>Also known as:</em>
  $pol.govtrackid (GovTrack), 
  $pol.opensecretsid (OpenSecrets), 
  $pol.bioguideid (Congressional Bio), 
  $pol.icpsrid (ICPSR), 
  $pol.votesmartid (Vote Smart)\
$if pol.fec_ids:
    , \
    $for fec_id in pol.fec_ids: $fec_id \
    (FEC)\
</p>
