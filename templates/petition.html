$def with (p, signform, useremail, isauthor, msg=None)

$var title: $p.title

<style>
fieldset#signpetition input {
    width: 500px;
}
fieldset#signpetition {
    margin-top: 2em;
}
</style>

$if msg:
    $var msg: $:msg

<div id="upperbar">
$if p.signatory_count == 0:
        <h2>Be the first to sign this petition!</h2>
$else:
	$if p.signatory_count == 1:
		$ ppl = 'person</a></strong> has'
	$else:
		$ ppl = 'people</a></strong> have'
	<h2> <strong><a href='/c/$p.id/signatories'>$p.signatory_count $:ppl signed this petition. </h2>

<div id="uppermenu">
  <a href="/c/$p.id/share">Share</a>&nbsp;
$if isauthor:
    <a href="?m=edit">Edit</a>
    <a href="?m=delete">Delete</a>
</div>
</div>

<p>$:format(p.description)</p>

<form name="sign" method="POST" action="/c/$p.id?m=sign">
        $if not signform.valid: <p class="error">Please try again after fixing the errors highlighted below:</p>
        <fieldset id="signpetition">
            <legend>Sign this petition</legend>
            <label for="fname">First name</label>
            $:signform.fname.render()
            <label for="lname">Last name</label>
            $:signform.lname.render()
            $if not useremail: 
                <label for="email">Email</label>
                $:signform.email.render()
            <label for="comment">Comment</label>
            $:signform.comment.render()
        </fieldset>
    <p><button type="submit">Sign this petition</button></p>
</form>


